{"version":3,"sources":["mitragyna.jsx"],"names":["Collection","state","loading","target","prototype","build","bindAll","setTarget","props","nextProps","subject","isRelationship","isA","Associations","CollectionProxy","setLoadedTarget","setState","base","loaded","load","then","isUndefined","all","attributes","cloneTarget","push","newItem","oldItem","replace","item","delete","clone","blankComponent","children","className","component","componentProps","reflection","size","map","t","indexOf","replaceOnTarget","id","klass","toArray","PureComponent","propTypes","oneOfType","array","node","string","func","object","isRequired","defaultProps","inlineRows","ErrorsFor","nextState","nextContext","context","resource","field","errors","forField","empty","customProps","omit","keys","finalComponent","createElement","key","error","code","message","Component","contextTypes","Field","type","value","changeRadio","radioValue","valueFor","invalidClassName","name","classNames","onChange","handleUpdate","onBlur","handleChange","renderCheckboxComponent","renderRadioComponent","renderRadioGroupComponent","renderSelectComponent","renderTextareaComponent","renderInputComponent","uncheckedValue","resourceValue","isNull","val","componentFor","checkboxProps","commonInputProps","checked","inputProps","radioProps","includeBlank","options","optionsLabel","selectOptions","o","isString","unshift","omittedKeys","selectProps","textareaProps","e","callback","persist","queueChange","newValue","detect","any","childContextTypes","bool","instanceOf","number","Resource","root","reflectionInstance","reflectOnAssociation","inverseReflection","inverseOf","queuedChanges","updating","afterUpdate","assignChanges","updateRoot","length","newResource","assignAttributes","oldTarget","association","newTarget","collection","first","change","afterUpdateRoot","updatingRoot","childContext","isNestedResource","preventDefault","onSubmit","onInvalidSubmit","onSubmitCallback","resourceToSubmit","onInvalidSubmitCallback","invalidResource","componentRef","beforeSubmit","Promise","resolve","catch","afterError","body","ref","c","handleSubmit","newRoot"],"mappings":"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","file":"mitragyna.min.js","sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport ActiveResource from 'active-resource';\nimport _ from 'underscore';\n\nexport class Collection extends React.PureComponent {\n  static propTypes = {\n    children: PropTypes.oneOfType([\n      PropTypes.array,\n      PropTypes.node,\n    ]),\n    className: PropTypes.string,\n    blankComponent: PropTypes.func,\n    component: PropTypes.func,\n    componentProps: PropTypes.object,\n    subject: PropTypes.oneOfType([\n      PropTypes.object,\n      PropTypes.func,\n    ]).isRequired,\n    reflection: PropTypes.string,\n  };\n\n  static defaultProps = {\n    inlineRows: false\n  };\n\n  // link to global state by enabling afterLoad, afterAdd, afterRemove, afterUpdate callbacks that can call\n  // an action linked to dispatch\n\n  constructor() {\n    super();\n\n    this.state = {\n      loading: true,\n      target: ActiveResource.prototype.Collection.build()\n    };\n\n    _.bindAll(this,\n      'buildOnTarget',\n      'cloneTarget',\n      'replaceOnTarget',\n      'removeFromTarget',\n    );\n  }\n\n  componentDidMount() {\n    this.setTarget(this.props);\n  }\n\n  componentWillReceiveProps(nextProps) {\n    this.setTarget(nextProps);\n  }\n\n  setTarget(props) {\n    const { subject } = props;\n\n    let isRelationship = subject.isA(ActiveResource.prototype.Associations.prototype.CollectionProxy);\n\n    let setLoadedTarget = (target) => {\n      this.setState({ loading: false, target })\n    };\n\n    if(isRelationship) {\n      if(subject.base.loaded()) {\n        setLoadedTarget(subject.base.target)\n      } else {\n        subject.load()\n        .then(setLoadedTarget)\n      }\n    } else if(!_.isUndefined(subject.all)) {\n      subject.all()\n      .then(setLoadedTarget)\n    }\n  }\n\n  buildOnTarget(attributes) {\n    const { subject } = this.props;\n    let target = this.cloneTarget();\n\n    target.push(subject.build(attributes));\n\n    this.setState({ target: target });\n  }\n\n  replaceOnTarget(newItem, oldItem) {\n    let target = this.cloneTarget();\n\n    target.replace(oldItem, newItem);\n\n    return this.setState({ target });\n  }\n\n  removeFromTarget(item) {\n    let target = this.cloneTarget();\n\n    target.delete(item);\n\n    return this.setState({ target });\n  }\n\n  cloneTarget() {\n    return this.state.target.clone();\n  }\n\n  render() {\n    const { blankComponent, children, className, component, componentProps, reflection } = this.props;\n    const { loading, target } = this.state;\n\n    return (\n      <section className={ className }>\n        { loading ? (\n          <span>Loading</span>\n        ) : (\n          target.size() > 0 ? (\n            target.map((t, indexOf) =>\n              <Resource afterUpdate={ this.replaceOnTarget }\n                        component= { component } componentProps={{ ...componentProps, indexOf }}\n                        key={ t.id || (t.klass().className + '-' + indexOf) }\n                        reflection={reflection}\n                        subject={ t }>\n\n\n                { children }\n              </Resource>\n            ).toArray()\n          ) : (blankComponent != null &&\n            blankComponent()\n          )\n        )}\n      </section>\n    );\n  }\n}\n\nexport class ErrorsFor extends React.Component {\n  static propTypes = {\n    component: PropTypes.func,\n    field: PropTypes.string,\n  };\n\n  static contextTypes = {\n    resource: PropTypes.object,\n  };\n\n  shouldComponentUpdate(nextProps, nextState, nextContext) {\n    return !(shallowEqual(this.props, nextProps) && shallowEqual(this.state, nextState) && shallowEqual(this.context, nextContext));\n  }\n\n  render() {\n    const { resource } = this.context;\n    const { component, field } = this.props;\n\n    var errors = resource.errors().forField(field);\n\n    if(errors.empty()) return null;\n\n    let customProps = _.omit(this.props, _.keys(ErrorsFor.propTypes));\n\n    let finalComponent = component || 'summary';\n    return React.createElement(finalComponent, {\n      ...customProps,\n      key: field,\n    },\n      errors.map((error) => {\n        return <span key={ error.code }>{ error.message }</span>\n      }).toArray()\n    );\n  }\n};\n\nimport classNames from 'classnames';\nimport shallowEqual from 'shallowequal';\n\nexport class Field extends React.Component {\n  static contextTypes = {\n    changeRadio: PropTypes.func,\n    queueChange: PropTypes.func,\n    radioValue: PropTypes.any,\n    resource: PropTypes.object,\n  };\n\n  static childContextTypes = {\n    changeRadio: PropTypes.func,\n    radioValue: PropTypes.any,\n  };\n\n  static propTypes = {\n    className: PropTypes.string,\n    component: PropTypes.func,\n    includeBlank: PropTypes.bool,\n    name: PropTypes.string.isRequired,\n    options: PropTypes.instanceOf(ActiveResource.Collection),\n    optionsLabel: PropTypes.oneOfType([\n      PropTypes.string,\n      PropTypes.func,\n    ]),\n    type: PropTypes.string.isRequired,\n    uncheckedValue: PropTypes.oneOfType([\n      PropTypes.object,\n      PropTypes.func,\n      PropTypes.string,\n      PropTypes.number,\n    ]),\n    invalidClassName: PropTypes.string,\n    value: PropTypes.oneOfType([\n      PropTypes.object,\n      PropTypes.func,\n      PropTypes.string,\n      PropTypes.number,\n    ])\n  };\n\n  constructor() {\n    super();\n\n    _.bindAll(this,\n      'changeRadio',\n      'classNames',\n      'commonInputProps',\n      'handleChange',\n      'handleUpdate',\n      'renderCheckboxComponent',\n      'renderInputComponent',\n      'renderRadioComponent',\n      'renderSelectComponent',\n      'renderTextareaComponent',\n      'valueFor',\n    );\n\n    this.state = {};\n  }\n\n  shouldComponentUpdate(nextProps, nextState, nextContext) {\n    return !(shallowEqual(this.props, nextProps) && shallowEqual(this.state, nextState) && shallowEqual(this.context, nextContext));\n  }\n\n  getChildContext() {\n    const { type } = this.props;\n    const { value } = this.state;\n\n    switch(type) {\n      case 'radioGroup':\n        return {\n          changeRadio: this.changeRadio,\n          radioValue: value,\n        };\n    }\n  }\n\n  changeRadio(value) {\n    this.setState({ value })\n  }\n\n  componentWillMount() {\n    const { resource } = this.context;\n\n    // Set initial value to that of the resources\n    this.setState({\n      value: this.valueFor(resource, this.props)\n    });\n  }\n\n  classNames() {\n    const { className, invalidClassName, name } = this.props;\n    const { resource } = this.context;\n\n    return classNames(\n      className,\n      {\n        [invalidClassName]: !resource.errors().forField(name).empty()\n      }\n    );\n  }\n\n  commonInputProps() {\n    const { name, type } = this.props;\n\n    let props = {\n      className: this.classNames(),\n      key: name,\n    };\n\n    switch(type) {\n      case 'checkbox':\n      case 'number':\n      case 'radio':\n      case 'select':\n        props.onChange = this.handleUpdate;\n        break;\n      default:\n        props = {\n          ...props,\n          onBlur: this.handleUpdate,\n          onChange: this.handleChange,\n        }\n    }\n\n    return props;\n  }\n\n  componentFor(type) {\n    switch(type) {\n      case 'checkbox':\n        return this.renderCheckboxComponent();\n      case 'radio':\n        return this.renderRadioComponent();\n      case 'radioGroup':\n        return this.renderRadioGroupComponent();\n      case 'select':\n        return this.renderSelectComponent();\n      case 'textarea':\n        return this.renderTextareaComponent();\n      default:\n        return this.renderInputComponent();\n    }\n  }\n\n  // TODO: Add support for non-resource options on select and radio\n  valueFor(resource, props) {\n    const { name, type, uncheckedValue, value } = props;\n\n    switch(type) {\n      case 'checkbox':\n        var resourceValue = resource[name];\n        if(resourceValue == value) {\n          return true;\n        } else if(resourceValue == uncheckedValue || _.isUndefined(resourceValue) || _.isNull(resourceValue)) {\n          return false;\n        } else {\n          throw 'Field ' + name + ' with value ' + resource[name] + ' does not match value or uncheckedValue for checkbox'\n        }\n      case 'radio':\n      case 'select':\n        var val = resource[name]();\n        return val ? val.id : '';\n      default:\n        var val = resource[name];\n\n        return val ? val : '';\n    }\n  }\n\n  render() {\n    const { type } = this.props;\n\n    return this.componentFor(type);\n  }\n\n  renderCheckboxComponent() {\n    const { component, name } = this.props;\n\n    let checkboxProps = _.omit(this.props, _.keys(_.omit(Field.propTypes, 'type')));\n\n    let finalComponent = component || 'input';\n    return React.createElement(finalComponent, {\n      ...checkboxProps,\n      ...this.commonInputProps(),\n      checked: this.state.value,\n    });\n  }\n\n  renderInputComponent() {\n    const { component, name } = this.props;\n\n    let inputProps = _.omit(this.props, _.keys(_.omit(Field.propTypes, 'type')));\n\n    let finalComponent = component || 'input';\n    return React.createElement(finalComponent, {\n      ...inputProps,\n      ...this.commonInputProps(),\n      value: this.state.value,\n    });\n  }\n\n  renderRadioComponent() {\n    const { component, name, value } = this.props;\n    const { radioValue } = this.context;\n\n    if (_.isUndefined(value)) {\n      throw 'Input type=\"radio\" must have prop \"value\"';\n    }\n\n    let radioProps = _.omit(this.props, _.keys(_.omit(Field.propTypes, 'type')));\n\n    let finalComponent = component || 'input';\n    return React.createElement(finalComponent, {\n      ...radioProps,\n      ...this.commonInputProps(),\n      checked: value.id == radioValue,\n      value: value.id,\n    });\n  }\n\n  renderRadioGroupComponent() {\n    return <div>\n      { this.props.children }\n    </div>;\n  }\n\n  renderSelectComponent() {\n    const { component, includeBlank, name, options, optionsLabel } = this.props;\n\n    let selectOptions = null;\n    if (options.empty()) {\n      throw 'Input type=\"select\" must have options';\n    } else {\n      selectOptions = options.map((o) => {\n        return <option key={o.id} value={o.id}>\n          {\n            _.isString(optionsLabel) ? (\n              o[optionsLabel]\n            ) : (\n              optionsLabel(o)\n            )\n          }\n        </option>;\n      });\n      if (includeBlank) {\n        selectOptions.unshift(<option key={-1} value=''></option>);\n      }\n    }\n\n    let omittedKeys = component ? _.omit(Field.propTypes, 'type') : Field.propTypes;\n    let selectProps = _.omit(this.props, _.keys(omittedKeys));\n\n    let finalComponent = component || 'select';\n    return React.createElement(finalComponent, {\n      ...selectProps,\n      ...this.commonInputProps(),\n      value: this.state.value,\n    }, selectOptions.toArray());\n  }\n\n  renderTextareaComponent() {\n    const { component, name } = this.props;\n\n    let textareaProps = _.omit(this.props, _.keys(_.omit(Field.propTypes, 'type')));\n\n    let finalComponent = component || 'textarea';\n    return React.createElement(finalComponent, {\n      ...textareaProps,\n      ...this.commonInputProps(),\n      value: this.state.value,\n    });\n  }\n\n  handleChange(e, callback) {\n    e.persist();\n\n    const { type } = this.props;\n    const { changeRadio } = this.context;\n\n    let value;\n\n    switch(type) {\n      case 'checkbox':\n        value = e.target.checked;\n        break;\n      case 'radio':\n        changeRadio(e.target.value);\n      default:\n        value = e.target.value;\n    }\n\n    this.setState({ value }, callback);\n  }\n\n  handleUpdate(e) {\n    const { name, type, options, uncheckedValue, value } = this.props;\n    const { queueChange } = this.context;\n\n    this.handleChange(e, () => {\n      var newValue = e.target.value;\n\n      switch(type) {\n        case 'checkbox':\n          if(e.target.checked) {\n            newValue = value;\n          } else {\n            newValue = uncheckedValue;\n          }\n          break;\n        case 'radio':\n          newValue = value;\n          break;\n        case 'select':\n          newValue = options.detect((o) => o.id === newValue);\n          break;\n      }\n\n      queueChange({ [name]: newValue });\n    })\n  }\n}\n\nexport class Resource extends React.PureComponent {\n  static propTypes = {\n    afterError: PropTypes.func,\n    afterUpdate: PropTypes.func,\n    children: PropTypes.oneOfType([\n      PropTypes.array,\n      PropTypes.node,\n    ]),\n    className: PropTypes.string,\n    component: PropTypes.func,\n    componentProps: PropTypes.object,\n    onInvalidSubmit: PropTypes.func,\n    onSubmit: PropTypes.func,\n    reflection: PropTypes.string,\n    subject: PropTypes.object.isRequired,\n  };\n\n  static contextTypes = {\n    afterUpdateRoot: PropTypes.func,\n    isNestedResource: PropTypes.bool,\n    root: PropTypes.object,\n    updateRoot: PropTypes.func,\n    updatingRoot: PropTypes.bool,\n  };\n\n  static childContextTypes = {\n    afterUpdateRoot: PropTypes.func,\n    isNestedResource: PropTypes.bool,\n    queueChange: PropTypes.func,\n    resource: PropTypes.object,\n    root: PropTypes.object,\n    updateRoot: PropTypes.func,\n    updatingRoot: PropTypes.bool,\n  };\n\n  static defaultProps = {\n    componentProps: {}\n  };\n\n  constructor(props, context) {\n    super();\n\n    _.bindAll(this,\n      'assignChanges',\n      'queueChange',\n      'handleSubmit',\n      'updateRoot'\n    );\n\n    const { root } = context;\n    const { reflection, subject } = props;\n\n    let state = { resource: subject };\n\n    if(reflection) {\n      var reflectionInstance = root.klass().reflectOnAssociation(reflection);\n      if(_.isUndefined(reflectionInstance)) throw 'Reflection ' + reflection + ' not found.';\n      var inverseReflection = reflectionInstance.inverseOf();\n      if(_.isUndefined(inverseReflection)) throw 'Reflection ' + reflection + ' must have inverse.';\n\n      state = {\n        ...state,\n        inverseReflection,\n        queuedChanges: {},\n        reflection: reflectionInstance,\n        updating: false,\n      };\n    }\n\n    this.state = state;\n  }\n\n  componentWillReceiveProps(nextProps) {\n    const { afterUpdate } = this.props;\n    const { inverseReflection } = this.state;\n\n    this.setState({ resource: nextProps.subject });\n\n    if(afterUpdate && !inverseReflection) {\n      this.setState({ updating: false });\n      this.assignChanges();\n    }\n  }\n\n  componentDidCatch(error) {\n    return <p>{ error }</p>;\n  }\n\n  assignChanges() {\n    const { root, updateRoot } = this.context;\n    const { inverseReflection, queuedChanges, resource } = this.state;\n\n    if(_.keys(queuedChanges).length == 0) return;\n\n    var newResource = resource.assignAttributes(queuedChanges);\n\n    this.setState({ queuedChanges: {} });\n\n    if(inverseReflection) {\n      var oldTarget = resource.association(inverseReflection.name).target;\n      var newTarget = newResource.association(inverseReflection.name).target;\n\n      if(inverseReflection.collection()) {\n        // FIXME: Allow autosave inverseOf collection to appropriately handle multiple resources in the collection,\n        //   not just the first. If changing multiple fields of resource quickly, root may not be found in oldTarget\n        //   because it has already been replaced by a previous change\n        // var index = oldTarget.indexOf(root);\n        // var newRoot = newTarget.get(index);\n        updateRoot(newTarget.first());\n      } else {\n        updateRoot(newTarget);\n      }\n    } else {\n      this.updateRoot(newResource);\n    }\n  }\n\n  queueChange(change) {\n    const { afterUpdate } = this.props;\n    const { inverseReflection, queuedChanges, resource, updating } = this.state;\n    const { afterUpdateRoot, root, updatingRoot } = this.context;\n\n    this.setState({\n      queuedChanges: {\n        ...queuedChanges,\n        ...change\n      }\n    }, () => {\n      if(afterUpdate || afterUpdateRoot) {\n        if(inverseReflection) {\n          if(!updatingRoot) this.assignChanges();\n        } else {\n          if(!updating) this.assignChanges();\n        }\n      } else {\n        this.assignChanges();\n      }\n    });\n  }\n\n  getChildContext() {\n    const { afterUpdate } = this.props;\n    const { root } = this.context;\n    const { resource, updating } = this.state;\n\n    let childContext = {\n      afterUpdateRoot: afterUpdate,\n      isNestedResource: true,\n      queueChange: this.queueChange,\n      root: root || resource,\n      resource,\n      updateRoot: this.updateRoot,\n      updatingRoot: updating,\n    };\n\n    return childContext;\n  }\n\n  handleSubmit(e) {\n    e.preventDefault();\n\n    const { onSubmit, onInvalidSubmit } = this.props;\n    const { resource } = this.state;\n\n    var onSubmitCallback = (resourceToSubmit) => {\n      if(!_.isUndefined(onSubmit)) {\n        onSubmit(resourceToSubmit);\n      }\n    };\n\n    var onInvalidSubmitCallback = (invalidResource) => {\n      if(!_.isUndefined(onInvalidSubmit)) {\n        onInvalidSubmit(invalidResource);\n      }\n    };\n\n    if(!_.isUndefined(this.componentRef.beforeSubmit)) {\n      Promise.resolve(this.componentRef.beforeSubmit(resource)).then(onSubmitCallback).catch(onInvalidSubmitCallback)\n    } else {\n      onSubmitCallback(resource);\n    }\n  }\n\n  render() {\n    const { isNestedResource } = this.context;\n    const { afterError, children, className, component, componentProps } = this.props;\n    const { resource } = this.state;\n\n    let body;\n    if(component) {\n      body = React.createElement(component, {\n        ...componentProps,\n        afterUpdate: this.afterUpdate,\n        afterError,\n        subject: resource,\n        ref: (c) => { this.componentRef = c }\n      });\n    } else {\n      body = children;\n    }\n\n    if(isNestedResource) {\n      return (\n        <section className={ className }>\n          { body }\n        </section>\n      );\n    } else {\n      return <form className={className} onSubmit={ this.handleSubmit }>{ body }</form>;\n    }\n  }\n\n  updateRoot(newRoot) {\n    const { afterUpdate } = this.props;\n    const { resource } = this.state;\n\n    this.setState({ resource: newRoot });\n\n    if(afterUpdate) {\n      afterUpdate(newRoot, resource);\n      this.setState({ updating: true })\n    }\n  }\n}\n"]}