{"version":3,"sources":["mitragyna.jsx"],"names":["Collection","state","loading","target","Immutable","List","bindAll","setTarget","props","nextProps","subject","isRelationship","isA","prototype","Associations","CollectionProxy","setLoadedTarget","setState","toArray","base","loaded","load","then","isUndefined","all","attributes","push","build","newItem","oldItem","index","findIndex","i","set","item","localId","delete","blankComponent","children","className","component","inlineRows","rowClassName","size","map","t","replaceOnTarget","PureComponent","propTypes","oneOfType","array","node","string","func","bool","object","isRequired","defaultProps","ErrorsFor","attribute","resource","errors","forField","message","code","Input","name","type","context","value","selectValueFor","inline","input","createSelectElement","createInputElement","createElement","key","onBlur","handleUpdate","onChange","handleChange","id","includeBlank","options","optionsLabelKey","selectOptions","isEmpty","o","unshift","selectProps","omit","keys","e","persist","afterUpdate","find","assignAttributes","contextTypes","Resource","root","reflection","reflectionInstance","reflectOnAssociation","inverseReflection","inverseOf","newResource","updateRoot","association","childContext","isNestedResource","body","newRoot","fromSave","save","resourceRoot","childContextTypes"],"mappings":"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","file":"mitragyna.min.js","sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport ActiveResource from 'active-resource';\nimport _ from 'underscore';\n\nexport class Collection extends React.PureComponent {\n  static propTypes = {\n    children: PropTypes.oneOfType([\n      PropTypes.array,\n      PropTypes.node,\n    ]),\n    className: PropTypes.string,\n    blankComponent: PropTypes.func,\n    component: PropTypes.func,\n    inlineRows: PropTypes.bool,\n    rowClassName: PropTypes.string,\n    subject: PropTypes.oneOfType([\n      PropTypes.object,\n      PropTypes.func,\n    ]).isRequired,\n  };\n\n  static defaultProps = {\n    inlineRows: false\n  };\n\n  // link to global state by enabling afterLoad, afterAdd, afterRemove, afterUpdate callbacks that can call\n  // an action linked to dispatch\n\n  constructor() {\n    super();\n\n    this.state = {\n      loading: true,\n      target: Immutable.List()\n    };\n\n    _.bindAll(this,\n      'buildOnTarget',\n      'replaceOnTarget',\n      'removeFromTarget',\n    );\n  }\n\n  componentDidMount() {\n    this.setTarget(this.props);\n  }\n\n  componentWillReceiveProps(nextProps) {\n    this.setTarget(nextProps);\n  }\n\n  setTarget(props) {\n    const { subject } = props;\n\n    let isRelationship = subject.isA(ActiveResource.prototype.Associations.prototype.CollectionProxy);\n\n    let setLoadedTarget = (target) => this.setState({ loading: false, target: Immutable.List(target.toArray()) });\n\n    if(isRelationship) {\n      if(subject.base.loaded()) {\n        setLoadedTarget(subject.base.target)\n      } else {\n        subject.load()\n        .then(setLoadedTarget)\n      }\n    } else if(!_.isUndefined(subject.all)) {\n      subject.all()\n      .then(setLoadedTarget)\n    }\n  }\n\n  buildOnTarget(attributes) {\n    const { subject } = this.props;\n    const { target } = this.state;\n\n    this.setState({ target: target.push(subject.build(attributes)) });\n  }\n\n  replaceOnTarget(newItem, oldItem) {\n    let index = this.state.target.findIndex((i) => i == oldItem);\n    return this.setState({ target: this.state.target.set(index, newItem) });\n  }\n\n  removeFromTarget(item) {\n    let index = this.state.target.findIndex((i) => i.localId == item.localId);\n    return this.setState({ target: this.state.target.delete(index) });\n  }\n\n  render() {\n    const { blankComponent, children, className, component, inlineRows, rowClassName } = this.props;\n    const { loading, target } = this.state;\n\n    return (\n      <section className={ className }>\n        { loading ? (\n          <span>Loading</span>\n        ) : (\n          target.size > 0 ? (\n            target.map((t) =>\n              <Mitragyna.Resource subject={ t } key={ t.localId } component= { component }\n                        className={ rowClassName } inline={ inlineRows }\n                        afterUpdate={ this.replaceOnTarget }>\n                { children }\n              </Mitragyna.Resource>\n            )\n          ) : (blankComponent != null &&\n            blankComponent()\n          )\n        )}\n      </section>\n    );\n  }\n}\n\nexport class ErrorsFor extends React.PureComponent {\n  static propTypes = {\n    attribute: PropTypes.string,\n    resource: PropTypes.object.isRequired,\n  };\n\n  render() {\n    const { attribute, resource } = this.props;\n\n    if(_.size(resource.errors().forField(attribute)) < 1) {\n      return null;\n    }\n\n    return(\n      <p className='dark-red f6 mt2 mb0'>\n        {\n          _.map(resource.errors().forField(attribute),\n            (message, code) => <span key={ code } className='db'>{ message }</span>\n          )\n        }\n      </p>\n    );\n  }\n};\n\nexport class Input extends React.PureComponent {\n  static contextTypes = {\n    afterUpdate: PropTypes.func,\n    inline: PropTypes.bool,\n    resource: PropTypes.object,\n  };\n\n  static propTypes = {\n    includeBlank: PropTypes.bool,\n    options: PropTypes.array,\n    optionsLabelKey: PropTypes.string,\n  };\n\n  constructor() {\n    super();\n\n    _.bindAll(this,\n      'createInputElement',\n      'createSelectElement',\n      'handleChange',\n      'handleUpdate',\n    );\n  }\n\n  componentWillMount() {\n    const { name, type } = this.props;\n    const { resource } = this.context;\n\n    // Set initial value to that of the resources\n    this.setState({\n      value: type == 'select' ? this.selectValueFor(resource[name]()) : resource[name]\n    });\n  }\n\n  render() {\n    const { name, type } = this.props;\n    const { inline, resource } = this.context;\n\n    let input = (type === 'select') ? this.createSelectElement() : this.createInputElement();\n\n    return React.createElement(inline ? 'span' : 'div', {}, [\n      input, <Mitragyna.ErrorsFor attribute={ name } resource={ resource } key='errors' />\n    ]);\n  }\n\n  createInputElement() {\n    const { name } = this.props;\n\n    return React.createElement('input', {\n      ...this.props,\n      key: name,\n      onBlur: this.handleUpdate,\n      onChange: this.handleChange,\n      value: this.state.value,\n    });\n  }\n\n  // TODO: Add support for non-resource options\n  selectValueFor(resource) {\n    return resource && resource.id || '';\n  }\n\n  createSelectElement() {\n    const { includeBlank, name, options, optionsLabelKey } = this.props;\n\n    let selectOptions = null;\n    if (options.isEmpty()) {\n      throw 'Input type=\"select\" must have options';\n    } else {\n      selectOptions = options.map((o) => <option key={o.localId} value={o.id}>{o[optionsLabelKey]}</option>);\n      if (includeBlank) {\n        selectOptions = selectOptions.unshift(<option key={-1} value=''></option>);\n      }\n    }\n\n    let selectProps = _.omit(this.props, _.keys(Input.propTypes));\n\n    return React.createElement('select', {\n      ...selectProps,\n      key: name,\n      onBlur: this.handleUpdate,\n      onChange: this.handleChange,\n      value: this.state.value,\n    }, selectOptions);\n  }\n\n  handleChange(e) {\n    e.persist();\n\n    this.setState({\n      value: e.target.value\n    });\n  }\n\n  handleUpdate(e) {\n    e.persist();\n\n    const { afterUpdate, resource } = this.context;\n    const { name, type, options } = this.props;\n\n    var value = e.target.value;\n\n    if(type === 'select') {\n      value = options.find((o) => o.id === value);\n    }\n\n    afterUpdate(resource.assignAttributes({ [name]: value }));\n  }\n}\n\nexport class Resource extends React.PureComponent {\n  static propTypes = {\n    afterUpdate: PropTypes.func,\n    children: PropTypes.oneOfType([\n      PropTypes.array,\n      PropTypes.node,\n    ]),\n    className: PropTypes.string,\n    component: PropTypes.func,\n    inline: PropTypes.bool,\n    reflection: PropTypes.string,\n    subject: PropTypes.object.isRequired,\n  };\n\n  static contextTypes = {\n    isNestedResource: PropTypes.bool,\n    resourceRoot: PropTypes.object,\n    updateRoot: PropTypes.func,\n  };\n\n  static childContextTypes = {\n    afterUpdate: PropTypes.func,\n    inline: PropTypes.bool,\n    isNestedResource: PropTypes.bool,\n    resource: PropTypes.object,\n    root: PropTypes.object,\n    updateRoot: PropTypes.func,\n  };\n\n  static defaultProps = {\n    inline: false\n  };\n\n  constructor(props, context) {\n    super();\n\n    _.bindAll(this,\n      'afterUpdate',\n      'updateRoot'\n    );\n  }\n\n  componentWillMount() {\n    const { root } = this.context;\n    const { reflection, subject } = this.props;\n\n    if(reflection) {\n      var reflectionInstance = root.reflectOnAssociation(reflection);\n      if(_.isUndefined(reflectionInstance)) throw 'Reflection ' + reflection + ' not found.';\n      var inverseReflection = reflectionInstance.inverseOf();\n      if(_.isUndefined(inverseReflection)) throw 'Reflection ' + reflection + ' must have inverse.';\n\n      this.setState({\n        inverseReflection,\n        reflection: reflectionInstance,\n      });\n    } else {\n      this.setState({ resource: subject });\n    }\n  }\n\n  componentWillReceiveProps(nextProps) {\n    this.setState({ resource: nextProps.subject });\n  }\n\n  afterUpdate(newResource) {\n    const { updateRoot } = this.context;\n    const { inverseReflection } = this.state;\n\n    if(inverseReflection) {\n      updateRoot(newResource.association(inverseReflection.name).target);\n    } else {\n      this.updateRoot(newResource);\n    }\n  }\n\n  getChildContext() {\n    const { root } = this.context;\n    const { inline } = this.props;\n    const { resource } = this.state;\n\n    let childContext = {\n      afterUpdate: this.afterUpdate,\n      inline,\n      isNestedResource: true,\n      root: root || this,\n      resource,\n      updateRoot: this.updateRoot\n    };\n\n    return childContext;\n  }\n\n  render() {\n    const { isNestedResource } = this.context;\n    const { children, className, component } = this.props;\n    const { resource } = this.state;\n\n    let body = null;\n    if(component) {\n      body = React.createElement(component, { subject: resource });\n    } else {\n      body = children;\n    }\n\n    if(!isNestedResource) {\n      body = <form>{ body }</form>;\n    }\n\n    return (\n      <section className={ className }>\n        { body }\n      </section>\n    );\n  }\n\n  updateRoot(newRoot, fromSave = false) {\n    const { afterUpdate } = this.context;\n    const { resource } = this.props;\n\n    this.setState({ resource: newRoot });\n\n    if(!_.isUndefined(afterUpdate)) afterUpdate(newRoot, resource);\n\n    if(!fromSave) {\n      newRoot.save((root) => this.updateRoot(root, true));\n    }\n  }\n}\n"]}